#!/usr/bin/env bash

# Source paths
FILES="$XDG_DATA_HOME/chezmoi/meta/shortcuts/files"
FILES_CM="$XDG_DATA_HOME/chezmoi/meta/shortcuts/files-chezmoi"
DIRS="$XDG_DATA_HOME/chezmoi/meta/shortcuts/directories"

# Shortcut files paths
ZSH_SC="$XDG_CONFIG_HOME/zsh/aliases-auto"
VIM_SC="$XDG_CONFIG_HOME/nvim/shortcuts.vim"

# Document files
echo "# vim: filetype=zsh" > "$ZSH_SC"
echo "# This file has been created automatically from the contents in" >> "$ZSH_SC"
echo "# $XDG_DATA_HOME/chezmoi/shortcuts" >> "$ZSH_SC"
echo "\" vim: filetype=vim" > "$VIM_SC"
echo "\" This file has been created automatically from the contents in" >> "$VIM_SC"
echo "\" $XDG_DATA_HOME/chezmoi/shortcuts" >> "$VIM_SC"

[ -f "$FILES" ] && sed "s/\s*#.*$//;/^\s*$/d" "$FILES" | tee \
  >(awk '{print "alias " $1 "=\"$EDITOR " $2 "\""}' >> "$ZSH_SC") \
  |(awk '{print "nmap " $1 " :e " $2 "<CR>" }' >> "$VIM_SC")

[ -f "$FILES_CM" ] && sed "s/\s*#.*$//;/^\s*$/d" "$FILES_CM" | tee \
  >(awk '{print "alias " $1 "=\"chezmoi edit --apply " $2 "\""}' >> "$ZSH_SC") \
  |(awk '{print "nmap " $1 " :e " $2 "<CR>" }' >> "$VIM_SC")

[ -f "$DIRS" ] && sed "s/\s*#.*$//;/^\s*$/d" "$DIRS" | \
  awk '{print "alias " $1 "=\"cd " $2 " && ls\""}' >> "$ZSH_SC"
